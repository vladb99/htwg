(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{Jgpi:function(t,e,i){"use strict";var a=i("TqRt");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=a(i("lSNA")),o=a(i("RIqP")),n=a(i("lwsE")),s=a(i("W8MJ")),l=a(i("uki+"));function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function d(t){for(var e=1;arguments.length>e;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){(0,r.default)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var h=function(){function t(){var e=this;(0,n.default)(this,t),this.mount=null,this.loaded=!1,this.fullDataLoaded=!1,this.timestamps=[],this.prices=[],this.points=[],this.minPrice=1e6,this.maxPrice=0,this.isModal=!1,this.isMobile=!1,this.zoomResetFnc=!1,this.boundControls=!1,this.defaultAge=31,this.fullAge=9999,this.tooltipListenerBound=!1,this.noOfferText="Kein Angebot",this.chart=null,this.onDataCallback=null,this._updateWrapperHeight=function(){e.isMobile&&e.isModal&&(e.mountEl.style.height="",window.requestAnimationFrame((function(){var t=Math.floor(e.mountEl.offsetHeight);t>0&&(t-=20,e.mountEl.style.height="".concat(t,"px"),e.chart.update())})))},this._createTooltip=function(t){Math.max(document.documentElement.clientWidth,window.innerWidth||0);var i=t.changedTouches&&t.changedTouches.length?Math.floor(t.changedTouches[0].clientX)-e.mountEl.getBoundingClientRect().left:t.clientX-e.mountEl.getBoundingClientRect().left,a=e._nearestTooltipMount(i);e._updateTooltip(a);var r=document.querySelector("#chartist-tooltip-point-".concat(e.mount));r&&r.removeAttribute("id"),a.setAttribute("id","chartist-tooltip-point-".concat(e.mount)),e.indicator.classList.remove("hide");var o=e.grid.getBoundingClientRect(),n=e.mountEl.getBoundingClientRect().top-o.top;e.indicator.style.height=o.height+"px",e.indicator.style.left=Math.round(+a.getAttribute("x2"))+"px",e.indicator.style.top=(-n>0?-n:n)+"px"},this._nearestTooltipMount=function(t){return e.points.reduce((function(e,i){return e&&t<Math.round(+i.getAttribute("x2"))?e:i}))},this._hideTooltip=function(){(0,o.default)(document.querySelectorAll(".ct-point")).map((function(t){return t.removeAttribute("id")})),e.indicator.classList.add("hide")},this._readPointValues=function(t){var i=t.getAttribute("ct:meta");if(!e.isModal&&"is-hole"!==i&&"is-graph"!==i)return{value:+t.getAttribute("ct:value"),date:i};var a=t.getAttribute("ct:value").split(",");return{value:"is-hole"===i?e.noOfferText:+a[1],date:e._getFormattedDate(new Date(+a[0])),date_raw:a[0]}},this._updateTooltip=function(t){var i=e._readPointValues(t),a=i.date,r=i.value,o=i.date_raw;if(e.tooltipValue.innerText=r!==e.noOfferText?"".concat(e._getFormattedValue(r)," ").concat(e.currency):r,e.tooltipDate.innerText=a,o){var n=new Date(Date.now()-864e5),s=new Date(+o);n.getDate()===s.getDate()&&n.getMonth()===s.getMonth()&&n.getYear()===s.getYear()&&(e.tooltipDate.innerText=document.querySelector("#transtext_gestern").innerText)}var l=e.isMobile?Math.round(+t.getAttribute("x2")):Math.round(+t.getAttribute("x2"))-e.tooltip.offsetWidth/2;e.tooltip.style.left="".concat(l,"px"),e.tooltip.style.top="".concat(Math.round(+t.getAttribute("y2"))-e.tooltip.offsetHeight-20,"px"),e.tooltip.classList.remove("hide")},this._onZoom=function(t,i){e.resetbtn.classList.remove("hidden"),e.zoomResetFnc||(e.zoomResetFnc=i),window.ga&&ga("send","event","Price history","Click","Zoom")},this._resetZoom=function(){e.zoomResetFnc&&e.zoomResetFnc(),e.zoomResetFnc=void 0,e.resetbtn.classList.add("hidden")},this._getFormattedDate=function(t){return e.dateFormat.replace("%d",t.getDate()).replace("%m",t.getMonth()+1).replace("%Y",t.getFullYear())},this._getFormattedValue=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return"en"===e.lang?t.toFixed(i):t.toFixed(i).replace(".",",")}}return(0,s.default)(t,[{key:"init",value:function(t,e,a,r){var o=this,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.mount=e;var s={age:this.defaultAge,isModal:!1,isMobile:_gh_storage.isMobile,currency:"EUR",dateFormat:"%d.%m.%Y",lang:"DE",idCount:1,onDataCallback:null,cacheEnabled:!0};n=Object.assign(d({},s),n),this.options=n,this.onDataCallback=n.onDataCallback;var l=n,c=l.age,h=l.isModal,u=l.isMobile,p=l.currency,m=l.dateFormat,g=l.lang,f=l.idCount,y=new RegExp("skinflint"),_=new RegExp("cenowarka"),v=window.location.href,w=y.test(v),b=_.test(v);p=w?"GBP":b?"PLN":"EUR",m=w?"%Y-%m-%d":"%d.%m.%Y",this.noOfferText=w?"No offers":b?"Brak ofert":"Kein Angebot",this.wrapperEl=document.querySelector("#".concat(e,"__wrapper")),this.mountEl=this.wrapperEl.querySelector(".pricehistory"),this.dataEl=this.wrapperEl.querySelector(".pricehistory-data"),this.nodataEl=this.wrapperEl.querySelector(".pricehistory-nodata-days"),this.nodataWrapperEl=this.wrapperEl.querySelector(".pricehistory-nodata"),this.neverHadDataEl=this.wrapperEl.querySelector(".pricehistory--never-had-data"),this.noMoreOfferEl=this.wrapperEl.querySelector(".pricehistory--no-more-offer"),this.lastOfferDateEl=this.wrapperEl.querySelector(".pricehistory__last-offer-date"),this.errorEl=this.wrapperEl.querySelector(".pricehistory-error"),this.controlsWrapper=document.querySelector(".".concat(e,"__controls")),this.controls=this.controlsWrapper?this.controlsWrapper.querySelectorAll(".".concat(e,"__control")):null,this.tooltip=this.wrapperEl.querySelector(".pricehistory-tooltip"),this.tooltipValue=this.wrapperEl.querySelector(".pricehistory-tooltip-value"),this.tooltipDate=this.wrapperEl.querySelector(".pricehistory-tooltip-date"),this.indicator=this.wrapperEl.querySelector(".pricehistory-indicator"),this.openingLink=this.wrapperEl.querySelector("#productpage__overview-links--pricehistory"),this.wrapperEl.querySelector(".pricehistory-nooffer")&&(this.noOfferText=this.wrapperEl.querySelector(".pricehistory-nooffer").innerText),h&&(this.resetbtn=document.querySelector(".".concat(e,"-resetbtn")),this.resetbtn.classList.add("hidden"),this.resetbtn.addEventListener("click",this._resetZoom),this.unfilteredPercentEl=document.querySelector(".".concat(e,"__unfiltered-bestprice-percent"))),this.bestprice=+r,this.id=t,this.mount=e,this.dataMount=a,this.isModal=h,this.isMobile=u,this.age=this.isModal&&window._gh_storage.priceHistoryTimerangeOverride?window._gh_storage.priceHistoryTimerangeOverride:c,this.lang=g,this.dateFormat=m,this.currency=this._currencyCaption(p);var E=[];E.push(i.e(65).then(i.t.bind(null,"eHdP",7))),Promise.all(E).then((function(){o._startLoading(),o._loadAndDrawData(f),o.errorEl&&o.errorEl.classList.add("hidden")})).catch((function(t){console.log(t),o.errorEl&&o.errorEl.classList.remove("hidden")}))}},{key:"_loadAndDrawData",value:function(t){var e=this,i=this.age!==this.defaultAge;if(!0===this.options.cacheEnabled&&window._gh_storage.priceHistoryData){var a=this._getDataForRange(window._gh_storage.priceHistoryData,this.age);return a&&(this._drawChart(a),this._createControls()),this.onDataCallback&&"function"==typeof this.onDataCallback&&this.onDataCallback(a),void this._stopLoading()}var r="".concat(window.location.href.replace(/\/[^\/]+$/,"/"),"?phist=").concat(this.id&&this.id.constructor===Array?this.id.join("&additional_id="):this.id,"&tableonly=1&age=").concat(i?this.fullAge:this.defaultAge);window._gh.ajax.load(r,(function(a){e.dataEl.innerHTML=a,e.data=e._jsonFromDomNode(".product__pricehistory-data")||[],e.options=e._jsonFromDomNode(".product__pricehistory-options")||{},e.listedSince=e._calculateDaysToNow(e.options.min_max.first),e.daysWithoutOffer=e.options.min_max.last_format;var r=e._prepareDataForGraph(i,t),o=e._getDataForRange(r,e.age);if(e.onDataCallback&&"function"==typeof e.onDataCallback&&e.onDataCallback(o),o&&0!==o.length||!e.nodataWrapperEl?o&&(e._drawChart(o),e._createControls(),e.nodataWrapperEl&&(e.nodataWrapperEl.style.display="")):(e.nodataWrapperEl.style.display="block",e.mountEl.classList.add("hide"),e._stopLoading()),e.bestprice&&document.getElementById("current_bestprice_today")?(document.getElementById("current_bestprice_value").innerText="".concat(e.currency," ").concat(e._formatPrice(""+e.bestprice)),document.getElementById("current_bestprice_today").classList.remove("hide"),document.querySelector("#current_bestprice_fallback").classList.add("hide")):document.querySelector("#current_bestprice_today")&&(document.querySelector("#current_bestprice_today").classList.add("hide"),document.querySelector("#current_bestprice_fallback").classList.remove("hide")),e.errorEl&&e.errorEl.classList.add("hidden"),e.options.min_max.last_format&&document.getElementById("pricehistory__last-offer")&&(document.getElementById("pricehistory__last-offer").innerText=e.options.min_max.last_format),e.options.min_max.last_format&&e.lastOfferDateEl&&(e.noMoreOfferEl.classList.remove("hide"),e.lastOfferDateEl.innerText=e.options.min_max.last_format),!e.options.min_max.last_format&&e.neverHadDataEl&&(e.neverHadDataEl.classList.remove("hide"),e.openingLink&&(e.openingLink.style.opacity="0.5",e.openingLink.style.pointerEvents="none")),e.unfilteredPercentEl&&e.options.unfiltered_bestprice&&e.options.bp_current){var n=e.bestprice-e.options.unfiltered_bestprice;n>0&&(e.unfilteredPercentEl.innerText="".concat(e.currency," ").concat(e._formatPrice(""+(Math.round(100*n)/100).toFixed(2))),document.querySelector("#unfiltered_bestprice").classList.remove("hide"))}}),null,null,null,(function(){e.errorEl&&e.errorEl.classList.remove("hidden")}))}},{key:"_calculateDaysToNow",value:function(t){return Math.floor(Math.abs(Date.now()-1e3*t)/1e3/86400)}},{key:"_jsonFromDomNode",value:function(t){try{return JSON.parse(this.dataEl.querySelector(t).innerText)}catch(t){return!1}}},{key:"_prepareDataForGraph",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a={modal:[],preview:[],holes:[]},r=[],o=this.data.filter((function(t){return!!t.length&&!!t[0]&&!isNaN(t[0])}));if(o.length){var n;this.mountEl.classList.remove("nodata"),o.map((function(t){r.push(t[0]);var o=new Date(t[0]),s=o.getTime();t[1]&&(n=t[1]),a.modal.push({x:s,y:t[1],complete:t[2]==i||1==i}),a.preview.push({meta:e._getFormattedDate(o),value:t[1],complete:t[2]==i||1==i}),a.holes.push({x:s,y:t[1]||n,meta:t[1]?"is-graph":"is-hole"}),!isNaN(t[1])&&t[1]>e.maxPrice&&(e.maxPrice=t[1]),!isNaN(t[1])&&t[1]<e.minPrice&&(e.minPrice=t[1])}));var s={prices:a,timestamps:r};return t&&(window._gh_storage.priceHistoryData=s),s}this.mountEl.classList.add("nodata")}},{key:"_getDataForRange",value:function(t,e){if(t){var i=this.isModal?t.prices.modal:t.prices.preview;return{timestamps:t.timestamps.slice(-e),prices:i.slice(-e),holes:t.prices.holes.slice(-e)}}}},{key:"_currencyCaption",value:function(t){switch(t){case"EUR":return"€";case"GBP":return"£";default:return t}}},{key:"_drawChart",value:function(t){var e=this;this.isMobile&&(this.tooltip.classList.add("hide"),this.indicator.classList.add("hide"));var i=t.timestamps,a=t.prices,r={labels:[i],series:[{name:"holes",data:t.holes},{name:"prices",data:a}]},n=this._getOptions(r),s=[];if(r.series[1].data.map((function(t,e){t.complete?(s.push(t),r.series[1].data[e+1]||r.series.push({name:"prices"+(r.series.length-1),data:s})):s.length&&(r.series.push({name:"prices"+(r.series.length-1),data:s}),s=[])})),r.series.length>2&&r.series.splice(1,1),this.isMobile&&r.labels[0]&&r.labels[0].length>0){var c=new Date(Date.now()-864e5),h=new Date(+i[i.length-1]);c.getDate()===h.getDate()&&c.getMonth()===h.getMonth()&&c.getYear()===h.getYear()&&(r.labels[0][r.labels[0].length-1]=document.querySelector("#transtext_gestern").innerText)}this.chart=new l.default.Line("#".concat(this.mount,"__wrapper .pricehistory"),r,n),this.chart.on("draw",(function(t){if(!e.isModal&&"line"===t.type&&1===t.seriesIndex){var i=t.path.pathElements.reduce((function(t,e,i){return 0===i?d(d({},t),{},{min:{y:e.y,value:e.data.value.y},max:{y:e.y,value:e.data.value.y}}):e.data.value.y<t.min.value?d(d({},t),{},{min:{y:e.y,value:e.data.value.y}}):e.data.value.y>t.max.value?d(d({},t),{},{max:{y:e.y,value:e.data.value.y}}):t}),{min:{y:0,value:1e5},max:{y:0,value:0}}),a=i.min,r=i.max,o=e.mountEl.offsetWidth,n={max:r.y,min:a.y},s=a.y-r.y;16>s&&0!==s&&(n.max=n.max-(16-s)/2,n.min=n.min+(16-s)/2),t.group.elem("text",{x:o,y:n.max+4},"ct-label ct-vertical ct-end ct-lastdate").text("".concat(e.currency," ").concat(Math.round(r.value))),r.value!==a.value&&t.group.elem("text",{x:o,y:n.min+4},"ct-label ct-vertical ct-end ct-lastdate").text("".concat(e.currency," ").concat(Math.round(a.value)))}})),this.chart.on("created",(function(){if(e.points=(0,o.default)(e.mountEl.querySelectorAll(".ct-series-a .ct-point")),e.grid=e.mountEl.querySelector(".ct-grids"),!e.tooltipListenerBound){if(e.tooltipListenerBound=!0,!e.isMobile)return e.mountEl.addEventListener("mousemove",e._createTooltip,!1),void e.mountEl.addEventListener("mouseleave",e._hideTooltip);e.mountEl.addEventListener("touchstart",e._createTooltip,!1),e.mountEl.addEventListener("touchmove",e._createTooltip,!1),e.mountEl.addEventListener("touchend",e._createTooltip,!1)}})),window.addEventListener("resize",this._onResize.bind(this)),this._stopLoading()}},{key:"_onResize",value:function(){this.chart?this._updateWrapperHeight():window.removeEventListener("resize",this._onResize)}},{key:"_formatPrice",value:function(t,e){var i=e||".00",a=(+t).toFixed(2)+"";return"en"===this.lang?(a.replace(".00",i),-1===a.indexOf(".")&&(t+=i)):(i=i.replace(".",","),-1===(a=a.replace(".",",").replace(",00",i)).indexOf(",")&&(a+=i)),a}},{key:"_getMinMax",value:function(t){var e=this.isModal?"y":"value",i=(t.series[1].data?t.series[1].data:t.series[1]).reduce((function(t,i,a){if(0===a)return d(d({},t),{},{min:i[e],max:i[e]});if(!i[e])return t;var r=d({},t);return i[e]<t.min&&(r.min=i[e]),i[e]>t.max&&(r.max=i[e]),r}),{min:1e5,max:0});return{min:i.min,max:i.max}}},{key:"_getOptions",value:function(t){var e=this,i=[],a=this._getMinMax(t),r=a.min,o=a.max,n=this._getYAxisLabelPadding(r,o),s=this._getYAxisBoundaries(r,o),c={height:"100%",fullWidth:!0,chartPadding:{top:8,right:n},lineSmooth:l.default.Interpolation.none({divisor:1,fillHoles:!1}),axisX:d(d({},this.isMobile?{}:{offset:0}),{},{showGrid:!1,showLabel:!!this.isMobile}),axisY:d({onlyInteger:!0,showLabel:!1,showGrid:!0,position:"end"},s),plugins:i};return this.isMobile&&(c.chartPadding.right=6,c.chartPadding.left=n,c.chartPadding.bottom=0,c.axisX.labelInterpolationFnc=function(t,i,a){var r;if(a=a[0],e._isAllowedLabel(i,a))return isNaN(a[i])&&a[i].length>0?a[i]:(r=new Date(a[i]),e._getFormattedDate(r))}),this.isModal?(c=d(d({},c),{},{low:0,chartPadding:{right:this.currency&&this.currency.length>=1?n:0,left:0},axisX:{type:l.default.AutoScaleAxis,showGrid:!1,showLabel:!0,labelInterpolationFnc:function(t,i,a){if(e._isAllowedLabel(i,a)){var r=new Date(t);return e._getFormattedDate(r)}}},axisY:d({type:l.default.AutoScaleAxis,onlyInteger:!0,showLabel:!0,showGrid:!0,position:"end",labelInterpolationFnc:function(t){return"".concat(e.currency," ").concat(t)}},s)}),i.push(l.default.plugins.zoom({onZoom:this._onZoom})),c):c}},{key:"_isAllowedLabel",value:function(t,e){var i=Math.round(e.length/6),a=Math.round(e.length/3),r=Math.round(e.length/2),o=Math.round(e.length/3*2),n=Math.round(e.length/6*5);return-1!==(this.isMobile&&30>e.length?[0,e.length-1]:[0,i,a,r,o,n,e.length-1]).indexOf(t)}},{key:"_getYAxisLabelPadding",value:function(t,e){var i=this.currency&&this.currency.length>=1?this.currency.length:0,a=(Math.round(t)+"").length+i,r=(Math.round(e)+"").length+i;return a>r&&(r=a),r&&r>3?(r>4&&(r*=3),r+5):0}},{key:"_getYAxisBoundaries",value:function(t,e){var i=t===e||1>e-t;if(this.isModal||i){var a=i?.5:.1;return{high:e+a,low:t-a}}var r={};this.isModal&&(r.high=e+.1,r.low=t-.1);var o=100*t/e;if(o>90&&(this.isModal||!this.isModal&&99.8>o)){var n=1;this.isModal||(o>99.6?n=20:o>99.4?n=18:o>99.2?n=12:o>99?n=10:o>98.8?n=7:o>98.5?n=6:o>98?n=5:o>97?n=4:o>96?n=3:o>95&&(n=2));var s=(100-o)*n+90;if(s>100&&(s=100),r.high=e*(100/s),r.low=t*(s/100),r.high<r.low)return{}}return r}},{key:"_createControls",value:function(){var t=this,e=this.isModal?0:1;this.controls&&!this.boundControls&&((0,o.default)(this.controls).map((function(i){var a=i.getAttribute("data-range"),r=window._gh_storage.priceHistoryData?window._gh_storage.priceHistoryData.timestamps.length:0;+a===t.age&&(r>=t.age||0===r)||"all"===a&&(t.age===t.fullAge||r<t.age)?i.classList.add("active"):i.classList.remove("active");var n=function(){if(t.isModal||(window._gh_storage.priceHistoryTimerangeOverride=a),"all"===a)t._drawChart(t._getDataForRange(window._gh_storage.priceHistoryData,9999));else if(window._gh_storage.fullPriceHistory||t.isModal){var e=t._getDataForRange(window._gh_storage.priceHistoryData,a);e&&t._drawChart(e)}else t.init(t.id,t.mount,t.dataMount,t.bestprice,{age:a,isModal:!1,isMobile:t.isMobile,currency:t.currency,dateFormat:t.dateFormat,lang:t.lang});(0,o.default)(t.controls).map((function(t){return t.classList.remove("active")})),i.classList.add("active"),t.isModal&&t.zoomResetFnc&&t._resetZoom()};t.isModal&&window._gh_storage.priceHistoryTimerangeOverride&&(0,o.default)(t.controls).map((function(t){return window._gh_storage.priceHistoryTimerangeOverride+""===t.getAttribute("data-range")?t.classList.add("active"):t.classList.remove("active")})),"all"!==a&&(t.isModal&&window._gh_storage.priceHistoryData.timestamps.length<a||!t.isModal&&t.listedSince<a)?(i.classList.add("hide"),i.addEventListener("click",n)):(i.addEventListener("click",n),e++)})),e>0&&this.controls&&this.controlsWrapper.classList.remove("hide"),this.boundControls=!0,this._updateWrapperHeight())}},{key:"_startLoading",value:function(){this.isModal&&_gh.modal?(_gh.modal.startLoading("modal-".concat(this.mount)),this.controlsWrapper.classList.add("hide")):this.mountEl.classList.remove("loaded")}},{key:"_stopLoading",value:function(){this.isModal&&_gh.modal?_gh.modal.stopLoading("modal-".concat(this.mount)):this.mountEl.classList.add("loaded")}}]),t}();e.default=h}}]);